schema_version: 1
task:
  task_id: null
  parent_cmd_id: null
  assigned_to: "{{WORKER_ID}}"
  assigned_at: ""
  status: idle

  title: ""
  description: ""
  repo_root: "."
  persona: ""
  # --- 品質ゲート拡張（QG-002）---
  phase: implement            # implement | review
  loop_count: 0               # int >= 0

  quality_gate:
    enabled_snapshot: true    # bool: タスク発行時の設定スナップショット
    gate_id: null             # 実装〜レビュー〜差し戻しを束ねるID
    implementer_worker_id: null
    reviewer_worker_id: null
    source_task_id: null      # review/rework時は元タスクID
    max_loop_count: 3
    checklist_template: ".yamibaito/templates/review-checklist.yaml"
    review_checklist: []      # phase: review で展開済みチェックリストを格納

  constraints:
    allowed_paths: []
    forbidden_paths: []
    deliverables: []
    shared_files_policy: warn
    tests_policy: none

  codex:
    mode: exec_stdin
    sandbox: workspace-write
    approval: on-request
    model: default
    web_search: false

  prompt: |
    あなたはこのYAMLに書かれているタスクを実行する。
    まずこのファイルを読み、taskの内容と制約を理解すること。

    ルール:
    - 共有ファイルは原則避ける。必要なら触ってよいが、必ずレポートで明記。
    - テストは原則実行しない（必要なら提案だけ）。
    - 指示されていない範囲のリファクタや整形はしない。
    - persona が指定されていれば、その専門家として作業する。

    作業が終わったら、以下のレポート形式で
    `.yamibaito/queue/reports/{{WORKER_ID}}_report.yaml` を更新すること。
    summary は1行で簡潔に書くこと。
    persona を使った場合は report.persona に記載すること。
